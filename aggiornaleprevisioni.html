<html>
<head>
<title>Area riservata</title>
</head>
<body>
  <h2>Previsioni per domani, <input id="titoloprevisioni" placeholder="giorno"></input></h2><br>
  <select id="simbolo" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select>
  <br><br><textarea id="testoprevisioni" placeholder="Testo" rows="30" style="width:500px;"></textarea><br><br>
  <input type="text" id="temperaturamax" placeholder="Massima"/><input type="text" id="temperaturamin" placeholder="Minima"/><br><br>

  <h2 style="float: left">Dalle 3 alle 6</h2><br> &nbsp;&nbsp;<select id="tresei" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select><br><br><br>
  <h2 style="float: left">Dalle 6 alle 9</h2><br> &nbsp;&nbsp;<select id="seinove" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select><br><br><br>
  <h2 style="float: left">Dalle 9 alle 12</h2><br> &nbsp;&nbsp;<select id="novedodici" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select><br><br><br>
  <h2 style="float: left">Dalle 12 alle 15</h2><br> &nbsp;&nbsp;<select id="dodiciquindici" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select><br><br><br>
  <h2 style="float: left">Dalle 15 alle 18</h2><br> &nbsp;&nbsp;<select id="quindicidiciotto" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select><br><br><br>
  <h2 style="float: left">Dalle 18 alle 21</h2><br> &nbsp;&nbsp;<select id="diciottoventuno" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select><br><br><br>
  <h2 style="float: left">Dalle 21 alle 24</h2><br> &nbsp;&nbsp;<select id="ventunoventiquattro" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select><br><br><br>
  <br><br>
  <h1>E il giorno dopo?</h1>
  <input id="giornodopo1" placeholder="Nome di dopodomani"></input>
  <input type="text" id="max1" placeholder="Massima"/><input type="text" id="min1" placeholder="Minima"/><br>

  <select id="seldopo" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select>
  <h1>E il giorno dopo ancora? (dopo il dopodomani)??</h1>
  <input id="giornodopo2" placeholder="Nome di dopo dopodomani"></input>
  <input type="text" id="max2" placeholder="Massima"/><input type="text" id="min2" placeholder="Minima"/><br><br>
  <select id="selldopo" style="width: 10%"><option value="Soleggiato"><h2>Soleggiato</h2></option><option value="Parzialmente soleggiato"><h2>Parz. soleggiato</h2></option><option value="Nuvoloso"><h2>Nuvoloso</h2></option><option value="Piovoso"><h2>Piovoso</h2></option><option value="Temporali"><h2>Temporali</h2></option></select>

  <br><br>
  <h1>News ora presenti</h1>
  <span id="oranotizie"></span>
  <h1>Aggiorna le news</h1>
  <select id="newstipo" style="width: 20%"><option value="Info"><h2>Informazione</h2></option><option value="Allerta"><h2>Allerta</h2></option><option value="Tendenza"><h2>Tendenza</h2></option></select>
  <br><br><input id="titolonews" placeholder="Titolo news"></input>
  <br><br>
  <textarea id="testonews" placeholder="Testo news" rows="10" style="width:500px;"></textarea>
  <br>
  <br>
  <select id="newsvis" style="width: 20%"><option value="uno"><h2>Aggiungi uno al totale</h2></option><option value="due"><h2>Cambia in "uno" il totale e resetta gli utenti</h2></option></select>
  <br><br><button onclick="news()"><h2>Registra news</h2></button>

  <br><br><br><input type="password" id="password" placeholder="Password"></input>
  <button onclick="aggiorna()">Aggiorna!</button>
  <br><br>

  <h1>Inserisci un debito</h1>
  <input type="number" id="nuovodebito" style="font-size:40px;" placeholder="Importo"></input>
  <input type="number" id="ore" style="font-size:30px;" placeholder="Quanti minuti"></input>
  <button onclick="confermanuovodebito()"><h1>Conferma!</h1></button>



  <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-database.js"></script>
<script>
var firebaseConfig = {
  apiKey: "AIzaSyCIw0-w1C3zDjoGgVpLKsFYm2TFXqJr9yw",
  authDomain: "marco-express-d30c8.firebaseapp.com",
  projectId: "marco-express-d30c8",
  storageBucket: "marco-express-d30c8.appspot.com",
  messagingSenderId: "764621319758",
  appId: "1:764621319758:web:9390a4a994df27cda4dd1f",
  measurementId: "G-3ZK6NW0G3F"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();

firebase.database().ref("Previsioni/Notizie").on("child_added", function (snapshot) {
 const notizia = snapshot.val();
 document.getElementById("oranotizie").innerHTML += "<h2>Titolo: " + notizia.Titolo + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Data: " + notizia.Data + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick='eliminanews(this)' data-id='" + snapshot.key + "'><h2>Elimina news</h2></button></h2>"
});

function aggiorna(){
  var prevtest = document.getElementById("testoprevisioni").value
  var prevtitolo = document.getElementById("titoloprevisioni").value
  var prevsimbolo = document.getElementById("simbolo").value
  var max = document.getElementById("temperaturamax").value
  var min = document.getElementById("temperaturamin").value


  if(document.getElementById("password").value === "009"){
    firebase.database().ref('Previsioni/Condizioni generali').update({
    testo: prevtest,
    titolo: "Previsioni per domani, " + prevtitolo,
    simbolo: prevsimbolo
  });
  firebase.database().ref('Previsioni/Temperature').update({
  massima: "°C " + max,
  minima: "°C " + min
});
firebase.database().ref('Previsioni/Orainora').update({
 da3a6: document.getElementById("tresei").value ,
 da6a9: document.getElementById("seinove").value ,
 da9a12: document.getElementById("novedodici").value ,
 da12a15: document.getElementById("dodiciquindici").value ,
 da15a18: document.getElementById("quindicidiciotto").value ,
 da18a21: document.getElementById("diciottoventuno").value ,
 da21a24: document.getElementById("ventunoventiquattro").value
});
firebase.database().ref('Previsioni/giornodopo1').update({
 giorno: document.getElementById("giornodopo1").value,
 massima: "°C " + document.getElementById("max1").value,
 minima: "°C " + document.getElementById("min1").value,
 simbolo: document.getElementById("seldopo").value
});
firebase.database().ref('Previsioni/giornodopo2').update({
  giorno: document.getElementById("giornodopo2").value,
  massima: "°C " + document.getElementById("max2").value,
  minima: "°C " + document.getElementById("min2").value,
  simbolo: document.getElementById("selldopo").value
});

  }
}
function news(){
  const dbRef = firebase.database().ref();
  var adesso = new Date();
  var data = adesso.getDate() + "/" + adesso.getMonth() + "/" + adesso.getFullYear()
  firebase.database().ref("Previsioni/Notizie").push().set({
    Tipo: document.getElementById("newstipo").value ,
    Titolo: document.getElementById("titolonews").value ,
    Testo: document.getElementById("testonews").value ,
    Data: data
  });
  var niusvis = document.getElementById("newsvis").value
  if(niusvis === "uno"){
dbRef.child("Previsioni").get().then((snapshot) => {
  var totale = snapshot.val().Numeropost
  totale++
  firebase.database().ref('Previsioni').update({
      Numeropost: totale
    });
})
}else if(niusvis === "due"){
  firebase.database().ref('Previsioni').update({
      Numeropost: 1
    });
  firebase.database().ref('Utenti/SIe2jcTA55X9foYxtUOIstHRiHH2/Notifiche').update({
      notificapost: 0
    });
    firebase.database().ref('Utenti/4vyWwyJYCtSCBoz6pbDCrXjvEEb2/Notifiche').update({
        notificapost: 0
      });
      firebase.database().ref('Utenti/mjFamto1aHaixjpoAopYiL9KEVg1/Notifiche').update({
          notificapost: 0
        });
        firebase.database().ref('Utenti/Qv5vod6GSrPKGUrtsmwU6pmMlkB2/Notifiche').update({
            notificapost: 0
          });
          firebase.database().ref('Utenti/4C5n2tskIgNIiokwgcc935dGvlY2/Notifiche').update({
              notificapost: 0
            });
            firebase.database().ref('Utenti/shKZK0SWjEMi1LRGZdNEvXK1m8l2/Notifiche').update({
                notificapost: 0
              });
}

}
function eliminanews(self){
    const dbRef = firebase.database().ref();
  var newsId = self.getAttribute("data-id");
  dbRef.child("Previsioni").get().then((snapshot) => {
    var totale = snapshot.val().Numeropost
    totale--
    firebase.database().ref('Previsioni').update({
        Numeropost: totale
      });
  })
  firebase.database().ref("Previsioni/Notizie").child(newsId).remove();
}

function confermanuovodebito(){
  var imp = document.getElementById("nuovodebito").value
  var quantohair = document.getElementById("ore").value
  var nn = "Marco Hairdresser: " + quantohair + " minuti"
  var oggi = new Date();
  var giorno = oggi.getDate()
  var mese = oggi.getMonth()
  var anno = oggi.getFullYear()
  var minuti = oggi.getMinutes()
  var ore = oggi.getHours()
  mese++
  var componi = giorno + "/" + mese + "/" + anno + " - " + ore + ":" + minuti

  firebase.database().ref('Utenti/4C5n2tskIgNIiokwgcc935dGvlY2/Debito').set({
    importo: imp,
    nome: nn,
    data: componi
  });
}
</script>
<style>

</style>
</body>
</html>
