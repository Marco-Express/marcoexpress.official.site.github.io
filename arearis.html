<html>
<head>
<title>Area riservata</title>
</head>
<body>

  <h1>Aggiungi denaro all'account</h1>
  <input type="text" placeholder="Email" id="email"></input><br><br>
  <input type="password" placeholder="Password" id="password"/>
  <br>
<button onclick="signIn()" id="signIn"><h1><b>Login</b></h1></button><br><br>
<input type='number' id='euro'></input><input type='text' id='pp'placeholder='Password amministratore'></input><button onclick='ok()'>Carica</button>
<button onclick='signOut()'>Esci</button>
  <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
<script>
var firebaseConfig = {
  apiKey: "AIzaSyCIw0-w1C3zDjoGgVpLKsFYm2TFXqJr9yw",
  authDomain: "marco-express-d30c8.firebaseapp.com",
  projectId: "marco-express-d30c8",
  storageBucket: "marco-express-d30c8.appspot.com",
  messagingSenderId: "764621319758",
  appId: "1:764621319758:web:9390a4a994df27cda4dd1f",
  measurementId: "G-3ZK6NW0G3F"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();


document.addEventListener('contextmenu', event => event.preventDefault(
  ));
function signIn(){
  if(navigator.onLine){
  var email = document.getElementById("email");
  var password = document.getElementById("password");
  const promise = auth.signInWithEmailAndPassword(email.value, password.value);
  promise.catch(e => alert('Combinazione utente/password errata'));

}else{
  document.getElementById('display').innerHTML = '<h1>Impossibile connetersi al server</h1>'
}}

auth.onAuthStateChanged(function(user){
   alert('Login effettuato user:' + user );
   user.providerData.forEach(function (profile) {
     var soldiora = profile.displayName
     alert('Soldi attuali: ' + soldiora)

   })
   });

   function signOut(){
     auth.signOut();
     alert("Disconnessione completata!");
     window.location.reload()

   }

   function ok() {
     var user = firebase.auth().currentUser;
     var pp = document.getElementById('pp').value
     if(pp === '009'){
       var eu = document.getElementById('euro').value
       user.providerData.forEach(function (profile) {
         var soldiora = Number(profile.displayName)
         var euu = Number(eu)
         var piu = soldiora+euu
         user.updateProfile({
        displayName: piu
      }).then(function() {
        console.log('primo ok')
      }).catch(function(error) {
        document.write("Errore")
      });

       })
     }else{
       document.write('Password non accettata')
     }
   }
</script>
<style>
#signOut {
  height: 25%;
  background: #f0cccc;
  width: 38%;
  border: 3px solid red;
  letter-spacing: 2px;
  border-radius: 15px;
  box-shadow: 10px 10px 5px #dedede;
}
#signIn {
  background: #b2f7bc;
  width: 200px;
  border: 3px solid #0af52c;
  letter-spacing: 2px;
  border-radius: 40px;
}
#password,#email {
  width:80%;
  background: #d5dbd6;
  border: 3px solid black;
  font-size: 250%;
  border-radius: 20px;
  box-shadow: 15px 10px 5px #dedede;
}
</style>
</body>
</html>
